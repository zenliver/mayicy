define("common/all",["common/utils/utils","arale/cookie/1.0.2/cookie","jquery/jquery/1.7.2/jquery","common/top-eventbind","./login-kuaiyin"],function(a){"use strict";function b(){a("common/utils/utils").isOnlyLoginZhubajie()&&a("./login-kuaiyin")()}function c(){b()}c()}),define("common/utils/utils",["arale/cookie/1.0.2/cookie","jquery/jquery/1.7.2/jquery","common/top-eventbind","common/logout"],function(a,b){"use strict";var c=a("arale/cookie/1.0.2/cookie"),d=a("jquery/jquery/1.7.2/jquery"),e=a("common/top-eventbind");b.isLogin=function(){return c.get("userid")&&c.get("kyln")?!0:!1},b.isOnlyLoginZhubajie=function(){return c.get("userid")&&!c.get("kyln")?!0:!1},b.updateTopBar=function(){var a='<a href="http://home.zhubajie.com/{{open_id}}/" target="_blank">{{nickname}}</a>\n<span class="global-tb-designer">\n    <a href="http://www.mayicy.cn/templet/designer">设计师专区</a>\n    <ul>\n        <li><a href="http://www.zhubajie.com/active/wikeyentrance" target="_blank">免费开店</a></li>\n        <li><a href="http://www.mayicy.cn/support/service/" target="_blank">百万扶持</a></li>\n        <li><a href="http://www.mayicy.cn/templet/designer" target="_blank">模板案例征集</a></li>\n        <li><a href="http://www.mayicy.cn/myky/design" target="_blank">我设计的模板</a></li>\n        <li><a href="http://www.mayicy.cn/myky/case" target="_blank">我上传的案例</a></li>\n        <li><a href="http://www.mayicy.cn/myky/imitation" target="_blank">我的仿制模板</a></li>\n        <li><a href="http://www.mayicy.cn/myky/fz_opus/" target="_blank">我的仿制作品</a></li>\n    \n    </ul>\n</span>\n<span class="global-tb-usermsg">\n    <a href="javascript:;"><i class="iconfont"></i></a>\n    <span class="tip">你有新的消息！</span>\n    <ul>\n        <li><a id="usermsg-trade" href="http://u.zhubajie.com/notice/list-type-1" target="_blank">查看交易提醒</a></li>\n        <li><a id="usermsg-recommend" href="http://u.zhubajie.com/officialtaskinvite/snatch" target="_blank">查看派单通知</a></li>\n        <li><a id="usermsg-system" href="http://u.zhubajie.com/notice/list-type-2" target="_blank">查看广告/活动信息</a></li>\n        <li><a id="usermsg-replay" href="http://u.zhubajie.com/taskcomment/commentlist-state-1.html" target="_blank">查看评论</a></li>\n        <li><a id="usermsg-logs" href="http://u.zhubajie.com/notice/chat" target="_blank">查看聊天记录</a></li>\n        <li><a id="usermsg-bid" href="http://u.zhubajie.com/taskcomment/bids" target="_blank">查看参与</a></li>\n        <li><a id="usermsg-thx" href="http://u.zhubajie.com/task/seller?s=5" target="_blank">查看谢谢</a></li>\n        <li><a id="usermsg-fans" href="http://u.zhubajie.com/fav/index-type-2" target="_blank">查看粉丝</a></li>\n    </ul>\n</span>\n<a href="javascript:;" data-action="logout" >[退出]</a>\n<a href="http://www.mayicy.cn/help">帮助</a>\n',b=d(".global-top-bar-right");try{window.parent&&window.parent.ZDK&&(console.log("刷新主站头部."),window.parent.ZDK.passport.refreshTopbar())}catch(c){}b[0]&&d.get("/ajax/user_info").done(function(c){c&&200===c.code&&(b.html(a.replace("{{open_id}}",c.data.open_id).replace("{{nickname}}",c.data.nickname)),e())})}}),define("common/top-eventbind",["jquery/jquery/1.7.2/jquery","common/logout"],function(a){"use strict";function b(){d(".global-tb-usermsg").on("mouseenter",function(){d(this).removeClass("new")}),d.ajax({url:"http://u.zhubajie.com/notice/getcount",dataType:"jsonp",jsonp:"jsonpcallback",success:function(a){var b=0;d(".global-tb-usermsg .highlight").remove(),d.each(a,function(a,c){c&&(b+=c,d('<span class="highlight">').text(c).appendTo("#usermsg-"+a))}),d(".global-tb-usermsg").toggleClass("new",!!b)}})}function c(){d(".global-top-bar").find("[data-action=logout]").click(function(b){a("common/logout").logout(),b.preventDefault()})}var d=a("jquery/jquery/1.7.2/jquery");return function(){console.log("bind top events..."),b(),c()}}),define("common/login-kuaiyin",["jquery/jquery/1.7.2/jquery","arale/cookie/1.0.2/cookie","common/utils/utils","common/top-eventbind"],function(a){"use strict";function b(b){c(function(c){e.post("/account/login",{token:c}).done(function(c){b&&b(c),a("common/utils/utils").updateTopBar()})})}function c(a){d("https://login."+global.zbj_domain+"/login/islogin",null,function(b){1===b.state&&a&&a(b.token)})}function d(a,b,c){e.ajax({url:a,type:"get",data:b,jsonp:"jsonpcallback",dataType:"jsonp",success:c})}{var e=a("jquery/jquery/1.7.2/jquery");a("arale/cookie/1.0.2/cookie")}return b});